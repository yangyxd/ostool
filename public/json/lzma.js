if(!Worker||(location&&location.protocol==="file:")){var Worker=function(script){var global_var,return_object={};if(typeof window!=="undefined"){global_var=window;}else if(global){global_var=global;}
if(global_var.document&&!global_var.require){global_var.require=function(path){var script_tag=document.createElement("script");script_tag.type="text/javascript";script_tag.src=path;document.getElementsByTagName("head")[0].appendChild(script_tag);};}
return_object.onmessage=function(){};return_object.postMessage=function(message){if(global_var.onmessage){global_var.onmessage({data:message});}else{setTimeout(function(){return_object.postMessage(message);},50);}};global_var.postMessage=function(e){return_object.onmessage({data:e,type:"message"});};require(script);return return_object;};}
this.LZMA=function(lzma_path){var action_compress=1,action_decompress=2,action_progress=3,callback_obj={},lzma_worker=new Worker((typeof lzma_path==="undefined"?"./lzma_worker.js":lzma_path));lzma_worker.onmessage=function(e){if(e.data.action===action_progress){if(callback_obj[e.data.callback_num]&&typeof callback_obj[e.data.callback_num].on_progress==="function"){callback_obj[e.data.callback_num].on_progress(e.data.result);}}else{if(callback_obj[e.data.callback_num]&&typeof callback_obj[e.data.callback_num].on_finish==="function"){callback_obj[e.data.callback_num].on_finish(e.data.result);delete callback_obj[e.data.callback_num];}}};lzma_worker.onerror=function(event){throw new Error(event.message+" ("+event.filename+":"+event.lineno+")");};return(function(){function send_to_worker(action,data,mode,on_finish,on_progress){var callback_num;do{callback_num=Math.floor(Math.random()*(10000000));}while(typeof callback_obj[callback_num]!=="undefined");callback_obj[callback_num]={on_finish:on_finish,on_progress:on_progress};lzma_worker.postMessage({action:action,callback_num:callback_num,data:data,mode:mode});}
return{compress:function(string,mode,on_finish,on_progress){send_to_worker(action_compress,String(string),mode,on_finish,on_progress);},decompress:function(byte_arr,on_finish,on_progress){send_to_worker(action_decompress,byte_arr,false,on_finish,on_progress);}};}());};